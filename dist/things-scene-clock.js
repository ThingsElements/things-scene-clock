!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@hatiolab/things-scene"),require("moment")):"function"==typeof define&&define.amd?define(["exports","@hatiolab/things-scene","moment"],t):t((e=e||self)["things-scene-clock"]={},e.scene,e.moment)}(this,function(e,t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;const a={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"hour-width",name:"hourWidth",property:"hourWidth"},{type:"number",label:"minute-width",name:"minuteWidth",property:"minuteWidth"},{type:"number",label:"second-width",name:"secondWidth",property:"secondWidth"},{type:"checkbox",label:"needle-round",name:"needleRound",property:"needleRound"},{type:"checkbox",label:"show-second",name:"showSecond",property:"showSecond"},{type:"checkbox",label:"show-number",name:"showNumber",property:"showNumber"},{type:"number",label:"inner-circle-size",name:"innerCircleSize",property:"innerCircleSize"},{type:"color",label:"inner-circle-color",name:"innerCircleColor",property:"innerCircleColor"}]};function i(e,t,n,a,i){e.beginPath(),e.lineWidth=a,e.lineCap=i?"round":"square",e.moveTo(0,0),e.rotate(t),e.lineTo(0,-n),e.stroke(),e.rotate(-t)}class r extends t.Ellipse{_draw(e){var t,n,{cx:a,cy:r,rx:l,ry:o,fillStyle:s,strokeStyle:c,fontColor:h="#000",lineWidth:m,hourWidth:u,minuteWidth:d,secondWidth:p,needleRound:b=!1,showSecond:y=!0,showNumber:g=!0,innerCircleSize:f=5,innerCircleColor:w="#000"}=this.model;if(e.beginPath(),e.ellipse(a,r,Math.abs(l),Math.abs(o),0,0,2*Math.PI),e.fillStyle=s,e.strokeStyle=c,e.lineWidth=m||.1*l,this.drawFill(e),this.drawStroke(e),e.beginPath(),e.translate(a,r),e.scale(1,o/l),g)for(e.font=.15*l+"px arial",e.textBaseline="middle",e.textAlign="center",e.fillStyle=h,n=1;n<13;n++)t=n*Math.PI/6,e.rotate(t),e.translate(0,.85*-l),e.rotate(-t),e.fillText(n.toString(),0,0),e.rotate(t),e.translate(0,.85*l),e.rotate(-t);var k,x=new Date,S=x.getHours(),C=x.getMinutes(),P=x.getSeconds();i(e,S=(S%=12)*Math.PI/6+C*Math.PI/360+P*Math.PI/21600,.55*l,u||.07*l,b),i(e,C=C*Math.PI/30+P*Math.PI/1800,.8*l,d||.07*l,b),y&&i(e,P=P*Math.PI/30,.9*l,p||.02*l,b),e.beginPath(),f&&(e.ellipse(0,0,f,f,0,0,2*Math.PI),e.fillStyle=w,e.fill()),e.beginPath(),e.scale(1,l/o),e.translate(-a,-r),k=setTimeout(function(e){e.invalidate(),clearTimeout(k)},1e3,this)}get nature(){return a}}t.Component.register("clock-analog",r);const l={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"time-format",name:"timeFormat"},{type:"checkbox",label:"is-local-time",name:"localTime"},{type:"number",label:"utc",name:"utc"},{type:"select",label:"week-language",name:"weekLanguage",property:{options:[{display:"English",value:"en"},{display:"Korean",value:"ko"},{display:"Chinese",value:"zh_cn"},{display:"Japanese",value:"ja"}]}}]};class o extends t.Text{get nature(){return l}render(e){super.render(e),this._raf=requestAnimationFrame(()=>{setTimeout(()=>{this._timer()},1e3)})}_timer(){this.set("data",this._getTimeStamp())}_getTimeStamp(){var e=n(),t=this.get("utc"),a=this.get("timeFormat")||"YYYY-MM-DD HH:mm:ss",i=this.get("weekLanguage");return this.get("weekLanguage")||(i="en"),this.get("localTime")?e.local():e.utc().utcOffset(t),e.locale(i).format(a)}dispose(){super.dispose(),cancelAnimationFrame(this._raf)}}t.Component.register("clock-text",o),e.ClockAnalog=r,e.ClockText=o,Object.defineProperty(e,"__esModule",{value:!0})});
